---
title: "02-demographic-data"
author: "Sara Shapiro"
date: '2022-11-29'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'C:/Users/Sara/Documents/GitHub/green-crab-metabolomics/data/') #Set root directory
setwd("C:/Users/Sara/Documents/GitHub/green-crab-metabolomics/data/") #Set root directory
```

## R Markdown

```{r packages, include=FALSE}
#install.packages("tidyverse")
#install.packages("RColorBrewer")
#install.packages("patchwork")
#install.packages("cowplot")
require(tidyverse)
require(RColorBrewer)
require(patchwork)
require(cowplot)
library(ggfortify)
library(ggplot2)
library(tidyverse)
library(ggpubr)
```


```{r data, echo=FALSE}
cw_data <- read.csv("carapace_width.csv")
cl_data <- read.csv("carapace_length.csv")
ig_data <- read.csv("integument_color.csv")
w_data <- read.csv("weight.csv")

```

```{r Carapace Width, echo=FALSE}

cw_1 <- cw_data[c(1:7,43:49,85:91,127:133,169:175,210:220),c(1,2:3)]
cw_2 <- cw_data[c(8:14,50:56,92:98,134:140,176:182,221:230),c(1,2:3)]
cw_3 <- cw_data[c(15:21,57:63,99:105,141:147,183:188,231:235),c(1,2:3)]
cw_4 <- cw_data[c(22:28,64:70,106:112,148:154,189:195,236:245),c(1,2:3)]
cw_5 <- cw_data[c(29:35,71:77,113:119,155:161,196:202,246:255),c(1,2:3)]
cw_6 <- cw_data[c(36:42,78:84,120:126,162:168,203:209,256:260),c(1,2:3)]

cw1_bp <- ggplot(data = cw_1, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.width)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Carapace Width", x = "Day") + ggtitle("Tank 1")
cw2_bp <- ggplot(data = cw_2, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.width)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Carapace Width", x = "Day") + ggtitle("Tank 2")
cw3_bp <- ggplot(data = cw_3, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.width)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Carapace Width", x = "Day") + ggtitle("Tank 3")
cw4_bp <- ggplot(data = cw_4, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.width)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Carapace Width", x = "Day") + ggtitle("Tank 4")
cw5_bp <- ggplot(data = cw_5, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.width)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Carapace Width", x = "Day") + ggtitle("Tank 5")
cw6_bp <- ggplot(data = cw_6, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.width)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Carapace Width", x = "Day") + ggtitle("Tank 6")


p_cw <- ((cw1_bp + rremove("x.text") | cw2_bp + rremove("x.text") | cw3_bp + rremove("x.text")) / (cw4_bp + rremove("x.text") | cw5_bp + rremove("x.text") | cw6_bp + rremove("x.text")))

p_cw + plot_annotation(title = 'Carapace Width Over Time')

```

```{r Carapace Length, echo=FALSE}
cl_1 <- cl_data[c(1:7,43:49,85:91,127:133,169:175,210:220),c(1,2:3)]
cl_2 <- cl_data[c(8:14,50:56,92:98,134:140,176:182,221:230),c(1,2:3)]
cl_3 <- cl_data[c(15:21,57:63,99:105,141:147,183:188,231:235),c(1,2:3)]
cl_4 <- cl_data[c(22:28,64:70,106:112,148:154,189:195,236:245),c(1,2:3)]
cl_5 <- cl_data[c(29:35,71:77,113:119,155:161,196:202,246:255),c(1,2:3)]
cl_6 <- cl_data[c(36:42,78:84,120:126,162:168,203:209,256:260),c(1,2:3)]

cl1_bp <- ggplot(data = cl_1, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.length)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Carapace Length", x = "Day") + ggtitle("Tank 1")
cl2_bp <- ggplot(data = cl_2, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.length)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Carapace Length", x = "Day") + ggtitle("Tank 2")
cl3_bp <- ggplot(data = cl_3, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.length)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Carapace Length", x = "Day") + ggtitle("Tank 3")
cl4_bp <- ggplot(data = cl_4, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.length)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Carapace Length", x = "Day") + ggtitle("Tank 4")
cl5_bp <- ggplot(data = cl_5, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.length)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Carapace Length", x = "Day") + ggtitle("Tank 5")
cl6_bp <- ggplot(data = cl_6, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.length)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Carapace Length", x = "Day") + ggtitle("Tank 6")


p_cl <- ((cl1_bp + rremove("x.text") | cl2_bp + rremove("x.text") | cl3_bp + rremove("x.text")) / (cl4_bp + rremove("x.text") | cl5_bp + rremove("x.text") | cl6_bp + rremove("x.text")))

p_cl + plot_annotation(title = 'Carapace Length Over Time')
```

```{r Weight, echo=FALSE}
w_1 <- w_data[c(1:7,43:49,85:91,127:133,169:175,210:220),c(1,2:3)]
w_2 <- w_data[c(8:14,50:56,92:98,134:140,176:182,221:230),c(1,2:3)]
w_3 <- w_data[c(15:21,57:63,99:105,141:147,183:188,231:235),c(1,2:3)]
w_4 <- w_data[c(22:28,64:70,106:112,148:154,189:195,236:245),c(1,2:3)]
w_5 <- w_data[c(29:35,71:77,113:119,155:161,196:202,246:255),c(1,2:3)]
w_6 <- w_data[c(36:42,78:84,120:126,162:168,203:209,256:260),c(1,2:3)]

w1_bp <- ggplot(data = w_1, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=weight)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Weight", x = "Day") + ggtitle("Tank 1")
w2_bp <- ggplot(data = w_2, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=weight)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Weight", x = "Day") + ggtitle("Tank 2")
w3_bp <- ggplot(data = w_3, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=weight)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Weight", x = "Day") + ggtitle("Tank 3")
w4_bp <- ggplot(data = w_4, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=weight)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Weight", x = "Day") + ggtitle("Tank 4")
w5_bp <- ggplot(data = w_5, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=weight)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Weight", x = "Day") + ggtitle("Tank 5")
w6_bp <- ggplot(data = w_6, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=weight)) + geom_boxplot() + geom_point() + stat_compare_means() + labs(y = "Weight", x = "Day") + ggtitle("Tank 6")


p_w <- ((w1_bp + rremove("x.text") | w2_bp + rremove("x.text") | w3_bp + rremove("x.text")) / (w4_bp + rremove("x.text") | w5_bp + rremove("x.text") | w6_bp + rremove("x.text")))

p_w + plot_annotation(title = 'Weight Over Time')


```

```{r Integument Color, echo=FALSE}
#ig_data$integument_color <- recode(ig_data$integument.color,"BG"="0.5","G"="1","YG"="1.5","Y"="2","YO"="2.5","O"="3","RO"="3.5")

#ig_all <- ig_data[c(1:260),c(1,2,4)]

#ig_1 <- ig_data[c(1:7,43:49,85:91,127:133,169:175,210:220),c(1,2,4)]
#ig_2 <- ig_data[c(8:14,50:56,92:98,134:140,176:182,221:230),c(1,2,4)]
#ig_3 <- ig_data[c(15:21,57:63,99:105,141:147,183:188,231:235),c(1,2,4)]
#ig_4 <- ig_data[c(22:28,64:70,106:112,148:154,189:195,236:245),c(1,2,4)]
#ig_5 <- ig_data[c(29:35,71:77,113:119,155:161,196:202,246:255),c(1,2,4)]
#ig_6 <- ig_data[c(36:42,78:84,120:126,162:168,203:209,256:260),c(1,2,4)]

#ig1_bp <- ggplot(data = ig_1, aes(x=factor(as.Date(date,format="%m/%d/%Y")), fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar() + theme(legend.position="none") + rremove("x.text") + labs(y = "Number of Crabs", x = "Day") + ggtitle("Tank 1")
#ig2_bp <- ggplot(data = ig_2, aes(x=factor(as.Date(date,format="%m/%d/%Y")), fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar() + theme(legend.position="none") + rremove("x.text") + labs(y = "Number of Crabs", x = "Day") + ggtitle("Tank 2")
#ig3_bp <- ggplot(data = ig_3, aes(x=factor(as.Date(date,format="%m/%d/%Y")), fill = integument_color)) + scale_fill_manual(values = c("#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar() + theme(legend.position="none") + rremove("x.text") + labs(y = "Number of Crabs", x = "Day") + ggtitle("Tank 3")
#ig4_bp <- ggplot(data = ig_4, aes(x=factor(as.Date(date,format="%m/%d/%Y")), fill = integument_color)) + scale_fill_manual(values = c("#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar() + theme(legend.position="none") + rremove("x.text") + labs(y = "Number of Crabs", x = "Day") + ggtitle("Tank 4")
#ig5_bp <- ggplot(data = ig_5, aes(x=factor(as.Date(date,format="%m/%d/%Y")), fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar() + theme(legend.position="none") + rremove("x.text") + labs(y = "Number of Crabs", x = "Day") + ggtitle("Tank 5")
#ig6_bp <- ggplot(data = ig_6, aes(x=factor(as.Date(date,format="%m/%d/%Y")), fill = integument_color)) + scale_fill_manual(values = c("#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar() + theme(legend.position="none") + rremove("x.text") + labs(y = "Number of Crabs", x = "Day") + ggtitle("Tank 6")

#ig_all_bp <- ggplot(data = ig_all, aes(x=factor(as.Date(date,format="%m/%d/%Y")), fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar() + labs(y = "Number of Crabs", x = "Day")
#legend_ig <- get_legend(ig_all_bp)

#title_ig <- ggdraw() + draw_label("Integument Color Over Time", fontface='bold')

#ig_plots <- align_plots(ig1_bp, ig2_bp, ig3_bp, ig4_bp, ig5_bp, ig6_bp, align = 'v', axis = '1')
#ig_top <- plot_grid(ig_plots[[1]], ig_plots[[2]], ig_plots[[3]], legend_ig, labels = c("1","2","3"), rel_widths = c(1, 1, 1, 1), nrow = 1)
#ig_bottom <- plot_grid(ig_plots[[4]], ig_plots[[5]], ig_plots[[6]], labels = c("4","5","6"), rel_widths = c(1, 1, 1, 1), nrow = 1)
#plot_grid(title_ig, ig_top, ig_bottom, ncol=1)


#chi_1 <- chisq.test(ig_1$date,ig_1$integument_color)
#chi_2 <- chisq.test(ig_2$date,ig_2$integument_color)
#chi_3 <- chisq.test(ig_3$date,ig_3$integument_color)
#chi_4 <- chisq.test(ig_4$date,ig_4$integument_color)
#chi_5 <- chisq.test(ig_5$date,ig_5$integument_color)
#chi_6 <- chisq.test(ig_6$date,ig_6$integument_color)

#chi_1
#chi_2
#chi_3
#chi_4
#chi_5
#chi_6

```


```{r Integument Color Percent Composition, echo=FALSE}
ig_data$integument_color <- recode(ig_data$integument.color,"BG"="0.5","G"="1","YG"="1.5","Y"="2","YO"="2.5","O"="3","RO"="3.5")

ig_all <- ig_data[c(1:260),c(1,2,4)]

ig_1 <- ig_data[c(1:7,43:49,85:91,127:133,169:175,210:220),c(1,2,4)]
ig_2 <- ig_data[c(8:14,50:56,92:98,134:140,176:182,221:230),c(1,2,4)]
ig_3 <- ig_data[c(15:21,57:63,99:105,141:147,183:188,231:235),c(1,2,4)]
ig_4 <- ig_data[c(22:28,64:70,106:112,148:154,189:195,236:245),c(1,2,4)]
ig_5 <- ig_data[c(29:35,71:77,113:119,155:161,196:202,246:255),c(1,2,4)]
ig_6 <- ig_data[c(36:42,78:84,120:126,162:168,203:209,256:260),c(1,2,4)]

ig1_bp <- ggplot(data = ig_1, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) +  geom_bar(position="fill", stat="identity") + theme(legend.position="none") + rremove("x.text") + labs(y = "Percent Composition", x = "Day") + ggtitle("Tank 1")
ig2_bp <- ggplot(data = ig_2, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + rremove("x.text") + labs(y = "Number of Crabs", x = "Day") + ggtitle("Tank 2")
ig3_bp <- ggplot(data = ig_3, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + rremove("x.text") + labs(y = "Number of Crabs", x = "Day") + ggtitle("Tank 3")
ig4_bp <- ggplot(data = ig_4, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + rremove("x.text") + labs(y = "Number of Crabs", x = "Day") + ggtitle("Tank 4") 
ig5_bp <- ggplot(data = ig_5, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + rremove("x.text") + labs(y = "Number of Crabs", x = "Day") + ggtitle("Tank 5")
ig6_bp <- ggplot(data = ig_6, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + rremove("x.text") + labs(y = "Number of Crabs", x = "Day") + ggtitle("Tank 6")

ig_all_bp <- ggplot(data = ig_all, aes(x=factor(as.Date(date,format="%m/%d/%Y")), fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar() + labs(y = "Number of Crabs", x = "Day")
legend_ig <- get_legend(ig_all_bp)

p_ig <- ((ig1_bp + rremove("x.text") | ig2_bp + rremove("x.text") | ig3_bp + rremove("x.text")) / (ig4_bp + rremove("x.text") | ig5_bp + rremove("x.text") | ig6_bp + rremove("x.text")))

p_ig + plot_annotation(title = 'Integument Color Over Time')


chi_1 <- chisq.test(ig_1$date,ig_1$integument_color)
chi_2 <- chisq.test(ig_2$date,ig_2$integument_color)
chi_3 <- chisq.test(ig_3$date,ig_3$integument_color)
chi_4 <- chisq.test(ig_4$date,ig_4$integument_color)
chi_5 <- chisq.test(ig_5$date,ig_5$integument_color)
chi_6 <- chisq.test(ig_6$date,ig_6$integument_color)

chi_1
chi_2
chi_3
chi_4
chi_5
chi_6

```

```{r Combined Treatments Over Time, echo=FALSE}
# combined treatments over time

cw_c <- rbind(cw_2, cw_5)
cw_a <- rbind(cw_1, cw_4)
cw_h <- rbind(cw_3, cw_6)

cw_c_bp <- ggplot(data = cw_c, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.width)) + geom_boxplot() + geom_point() + labs(y = "Carapace Width", x = "Day") + ggtitle('Cold Treatment') + stat_compare_means()
cw_a_bp <- ggplot(data = cw_a, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.width)) + geom_boxplot() + geom_point() + labs(y = "Carapace Width", x = "Day") + ggtitle('Ambient Treatment') + stat_compare_means()
cw_h_bp <- ggplot(data = cw_h, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.width)) + geom_boxplot() + geom_point() + labs(y = "Carapace Width", x = "Day") + ggtitle('Hot Treatment') + stat_compare_means()

cw_treatments_patch <- (cw_c_bp + rremove("x.text") | cw_a_bp + rremove("x.text") | cw_h_bp + rremove("x.text"))
cw_treatments_patch + plot_annotation(title = 'Carapace Width Across Treatments Over Time')
                               
##################
cl_c <- rbind(cl_2, cl_5)
cl_a <- rbind(cl_1, cl_4)
cl_h <- rbind(cl_3, cl_6)

cl_c_bp <- ggplot(data = cl_c, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.length)) + geom_boxplot() + geom_point() + labs(y = "Carapace Length", x = "Day") + ggtitle('Cold Treatment') + stat_compare_means()
cl_a_bp <- ggplot(data = cl_a, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.length)) + geom_boxplot() + geom_point() + labs(y = "Carapace Length", x = "Day") + ggtitle('Ambient Treatment') + stat_compare_means()
cl_h_bp <- ggplot(data = cl_h, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=carapace.length)) + geom_boxplot() + geom_point() + labs(y = "Carapace Length", x = "Day") + ggtitle('Hot Treatment') + stat_compare_means()

cl_treatments_patch <- (cl_c_bp + rremove("x.text") | cl_a_bp + rremove("x.text") | cl_h_bp + rremove("x.text"))
cl_treatments_patch + plot_annotation(title = 'Carapace Length Across Treatments Over Time')
##################
w_c <- rbind(w_2, w_5)
w_a <- rbind(w_1, w_4)
w_h <- rbind(w_3, w_6)

w_c_bp <- ggplot(data = w_c, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=weight)) + geom_boxplot() + geom_point() + labs(y = "Weight", x = "Day") + ggtitle('Cold Treatment') + stat_compare_means()
w_a_bp <- ggplot(data = w_a, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=weight)) + geom_boxplot() + geom_point() + labs(y = "Weight", x = "Day") + ggtitle('Ambient Treatment') + stat_compare_means()
w_h_bp <- ggplot(data = w_h, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=weight)) + geom_boxplot() + geom_point() + labs(y = "Weight", x = "Day") + ggtitle('Hot Treatment') + stat_compare_means()

w_treatments_patch <- (w_c_bp + rremove("x.text") | w_a_bp + rremove("x.text") | w_h_bp + rremove("x.text"))
w_treatments_patch + plot_annotation(title = 'Weight Across Treatments Over Time')
##################
ig_data$integument_color <- recode(ig_data$integument.color,"BG"="0.5","G"="1","YG"="1.5","Y"="2","YO"="2.5","O"="3","RO"="3.5")

ig_c <- rbind(ig_2, ig_5)
ig_a <- rbind(ig_1, ig_4)
ig_h <- rbind(ig_3, ig_6)

ig_c_bp <- ggplot(data = ig_c, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + labs(y = "Percent Composition", x = "Day") + ggtitle('Cold Treatment')
ig_a_bp <- ggplot(data = ig_a, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + labs(y = "Percent Composition", x = "Day") + ggtitle('Ambient Treatment')
ig_h_bp <- ggplot(data = ig_h, aes(x=factor(as.Date(date,format="%m/%d/%Y")), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + labs(y = "Percent Composition", x = "Day") + ggtitle('Hot Treatment')

ig_treatments_patch <- (ig_c_bp + rremove("x.text") | ig_a_bp + rremove("x.text") | ig_h_bp + rremove("x.text"))
ig_treatments_patch + plot_annotation(title = 'Integument Color Across Treatments Over Time')

chi_c <- chisq.test(ig_c$date,ig_c$integument_color)
chi_a <- chisq.test(ig_a$date,ig_a$integument_color)
chi_h <- chisq.test(ig_h$date,ig_h$integument_color)

chi_c
chi_a
chi_h
```

```{r Comparison between treatments across individual time points, echo=FALSE}

cw_8th <- cw_data[c(1:42),c(1,2:3)]
cw_12th <- cw_data[c(43:84),c(1,2:3)]
cw_15th <- cw_data[c(85:126),c(1,2:3)]
cw_19th <- cw_data[c(127:168),c(1,2:3)]
cw_22nd <- cw_data[c(169:209),c(1,2:3)]
cw_26th <- cw_data[c(210:260),c(1,2:3)]

cw8th_bp <- ggplot(data = cw_8th, aes(x=as.factor(treatment.tank), y=carapace.width)) + geom_boxplot() + geom_point() + labs(y = "Carapace Width", x = "Treatment") + stat_compare_means() + ggtitle("07/08/2022")
cw12th_bp <- ggplot(data = cw_12th, aes(x=as.factor(treatment.tank), y=carapace.width)) + geom_boxplot() + geom_point() + labs(y = "Carapace Width", x = "Treatment") + stat_compare_means() + ggtitle("07/12/2022")
cw15th_bp <- ggplot(data = cw_15th, aes(x=as.factor(treatment.tank), y=carapace.width)) + geom_boxplot() + geom_point() + labs(y = "Carapace Width", x = "Treatment") + stat_compare_means() + ggtitle("07/15/2022")
cw19th_bp <- ggplot(data = cw_19th, aes(x=as.factor(treatment.tank), y=carapace.width)) + geom_boxplot() + geom_point() + labs(y = "Carapace Width", x = "Treatment") + stat_compare_means() + ggtitle("07/19/2022")
cw22nd_bp <- ggplot(data = cw_22nd, aes(x=as.factor(treatment.tank), y=carapace.width)) + geom_boxplot() + geom_point() + labs(y = "Carapace Width", x = "Treatment") + stat_compare_means() + ggtitle("07/22/2022")
cw26th_bp <- ggplot(data = cw_26th, aes(x=as.factor(treatment.tank), y=carapace.width)) + geom_boxplot() + geom_point() + labs(y = "Carapace Width", x = "Treatment") + stat_compare_means() + ggtitle("07/26/2022")

p_cw_date <- ((cw8th_bp | cw12th_bp | cw15th_bp) / (cw19th_bp | cw22nd_bp | cw26th_bp))

p_cw_date + plot_annotation(title = 'Carapace Width Across Treatments')

#####

cl_8th <- cl_data[c(1:42),c(1,2:3)]
cl_12th <- cl_data[c(43:84),c(1,2:3)]
cl_15th <- cl_data[c(85:126),c(1,2:3)]
cl_19th <- cl_data[c(127:168),c(1,2:3)]
cl_22nd <- cl_data[c(169:209),c(1,2:3)]
cl_26th <- cl_data[c(210:260),c(1,2:3)]

cl8th_bp <- ggplot(data = cl_8th, aes(x=as.factor(treatment.tank), y=carapace.length)) + geom_boxplot() + geom_point() + labs(y = "Carapace Length", x = "Treatment") + stat_compare_means() + ggtitle("07/08/2022")
cl12th_bp <- ggplot(data = cl_12th, aes(x=as.factor(treatment.tank), y=carapace.length)) + geom_boxplot() + geom_point() + labs(y = "Carapace Length", x = "Treatment") + stat_compare_means() + ggtitle("07/12/2022")
cl15th_bp <- ggplot(data = cl_15th, aes(x=as.factor(treatment.tank), y=carapace.length)) + geom_boxplot() + geom_point() + labs(y = "Carapace Length", x = "Treatment") + stat_compare_means() + ggtitle("07/15/2022")
cl19th_bp <- ggplot(data = cl_19th, aes(x=as.factor(treatment.tank), y=carapace.length)) + geom_boxplot() + geom_point() + labs(y = "Carapace Length", x = "Treatment") + stat_compare_means() + ggtitle("07/19/2022")
cl22nd_bp <- ggplot(data = cl_22nd, aes(x=as.factor(treatment.tank), y=carapace.length)) + geom_boxplot() + geom_point() + labs(y = "Carapace Length", x = "Treatment") + stat_compare_means() + ggtitle("07/22/2022")
cl26th_bp <- ggplot(data = cl_26th, aes(x=as.factor(treatment.tank), y=carapace.length)) + geom_boxplot() + geom_point() + labs(y = "Carapace Length", x = "Treatment") + stat_compare_means() + ggtitle("07/26/2022")

p_cl_date <- ((cl8th_bp | cl12th_bp | cl15th_bp) / (cl19th_bp | cl22nd_bp | cl26th_bp))

p_cl_date + plot_annotation(title = 'Carapace Length Across Treatments')

########

w_8th <- w_data[c(1:42),c(1,2:3)]
w_12th <- w_data[c(43:84),c(1,2:3)]
w_15th <- w_data[c(85:126),c(1,2:3)]
w_19th <- w_data[c(127:168),c(1,2:3)]
w_22nd <- w_data[c(169:209),c(1,2:3)]
w_26th <- w_data[c(210:260),c(1,2:3)]

w8th_bp <- ggplot(data = w_8th, aes(x=as.factor(treatment.tank), y=weight)) + geom_boxplot() + geom_point() + labs(y = "Weight", x = "Treatment") + stat_compare_means() + ggtitle("07/08/2022")
w12th_bp <- ggplot(data = w_12th, aes(x=as.factor(treatment.tank), y=weight)) + geom_boxplot() + geom_point() + labs(y = "Weight", x = "Treatment") + stat_compare_means() + ggtitle("07/12/2022")
w15th_bp <- ggplot(data = w_15th, aes(x=as.factor(treatment.tank), y=weight)) + geom_boxplot() + geom_point() + labs(y = "Weight", x = "Treatment") + stat_compare_means() + ggtitle("07/15/2022")
w19th_bp <- ggplot(data = w_19th, aes(x=as.factor(treatment.tank), y=weight)) + geom_boxplot() + geom_point() + labs(y = "Weight", x = "Treatment") + stat_compare_means() + ggtitle("07/19/2022")
w22nd_bp <- ggplot(data = w_22nd, aes(x=as.factor(treatment.tank), y=weight)) + geom_boxplot() + geom_point() + labs(y = "Weight", x = "Treatment") + stat_compare_means() + ggtitle("07/22/2022")
w26th_bp <- ggplot(data = w_26th, aes(x=as.factor(treatment.tank), y=weight)) + geom_boxplot() + geom_point() + labs(y = "Weight", x = "Treatment") + stat_compare_means() + ggtitle("07/26/2022")

p_w_date <- ((w8th_bp | w12th_bp | w15th_bp) / (w19th_bp | w22nd_bp | w26th_bp))

p_w_date + plot_annotation(title = 'Weight Across Treatments')

#########

ig_data$integument_color <- recode(ig_data$integument.color,"BG"="0.5","G"="1","YG"="1.5","Y"="2","YO"="2.5","O"="3","RO"="3.5")

ig_8th <- ig_data[c(1:42),c(1,2,4)]
ig_12th <- ig_data[c(43:84),c(1,2,4)]
ig_15th <- ig_data[c(85:126),c(1,2,4)]
ig_19th <- ig_data[c(127:168),c(1,2,4)]
ig_22nd <- ig_data[c(169:209),c(1,2,4)]
ig_26th <- ig_data[c(210:260),c(1,2,4)]

ig8th_bp <- ggplot(data = ig_8th, aes(x=as.factor(treatment.tank), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + labs(y = "Percent Composition", x = "Treatment") + ggtitle("07/08/2022")
ig12th_bp <- ggplot(data = ig_12th, aes(x=as.factor(treatment.tank), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + labs(y = "Percent Composition", x = "Treatment") + ggtitle("07/12/2022")
ig15th_bp <- ggplot(data = ig_15th, aes(x=as.factor(treatment.tank), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + labs(y = "Percent Composition", x = "Treatment") + ggtitle("07/15/2022")
ig19th_bp <- ggplot(data = ig_19th, aes(x=as.factor(treatment.tank), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + labs(y = "Percent Composition", x = "Treatment") + ggtitle("07/19/2022")
ig22nd_bp <- ggplot(data = ig_22nd, aes(x=as.factor(treatment.tank), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + labs(y = "Percent Composition", x = "Treatment") + ggtitle("07/22/2022")
ig26th_bp <- ggplot(data = ig_26th, aes(x=as.factor(treatment.tank), y=treatment.tank, fill = integument_color)) + scale_fill_manual(values = c("#66C2A5","#A6D96A","#D9EF8B","#FFFF99","#FDAE61","#F46D43","#D53E4F")) + geom_bar(position="fill", stat="identity") + theme(legend.position="none") + labs(y = "Percent Composition", x = "Treatment") + ggtitle("07/26/2022")

p_ig_date <- ((ig8th_bp | ig12th_bp | ig15th_bp) / (ig19th_bp | ig22nd_bp | ig26th_bp))

p_ig_date + plot_annotation(title = 'Integument Color Across Treatments')

chi_8th <- chisq.test(ig_8th$treatment.tank,ig_8th$integument_color)
chi_12th <- chisq.test(ig_12th$treatment.tank,ig_12th$integument_color)
chi_15th <- chisq.test(ig_15th$treatment.tank,ig_15th$integument_color)
chi_19th <- chisq.test(ig_19th$treatment.tank,ig_19th$integument_color)
chi_22nd <- chisq.test(ig_22nd$treatment.tank,ig_22nd$integument_color)
chi_26th <- chisq.test(ig_26th$treatment.tank,ig_26th$integument_color)

chi_8th
chi_12th
chi_15th
chi_19th
chi_22nd
chi_26th
```